<!DOCTYPE html>
<html lang="en">
<head>
    <title>Product Details - ShopEasy</title>
</head>
<body>
    <!-- Navigation -->
    
    <!-- Product Detail Section -->
    <section class="py-5 mt-5">
        <div class="container">
            <div class="row" id="product-detail-container">
                <!-- Dynamic content from JS -->
            </div>
            
            <!-- Related Products -->
            <div class="row mt-5">
                <h3 class="mb-4">You May Also Like</h3>
                <div class="row g-4" id="related-products">
                    <!-- Related products loaded -->
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    
    <script src="js/main.js"></script>
    <script>
        // Get product ID from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const productId = parseInt(urlParams.get('id'));
        const product = products.find(p => p.id === productId);
        
        if (product) {
            document.title = product.name + ' - ShopEasy';
            const container = document.getElementById('product-detail-container');
            container.innerHTML = `
                <div class="col-md-6">
                    <img src="${product.image}" class="img-fluid rounded" alt="${product.name}">
                </div>
                <div class="col-md-6">
                    <h1 class="display-6 fw-bold">${product.name}</h1>
                    <div class="product-rating mb-3">
                        ${getStarRating(product.rating)} <span class="ms-2">(${product.rating} stars)</span>
                    </div>
                    <div class="mb-3">
                        <span class="product-price fs-2">$${product.price.toFixed(2)}</span>
                        ${product.oldPrice ? `<span class="product-old-price fs-4 ms-2">$${product.oldPrice.toFixed(2)}</span>` : ''}
                    </div>
                    <p class="lead">${product.description}</p>
                    <div class="mb-4">
                        <strong>Availability:</strong> 
                        <span class="${product.stock > 0 ? 'text-success' : 'text-danger'}">
                            ${product.stock > 0 ? 'In Stock (' + product.stock + ' available)' : 'Out of Stock'}
                        </span>
                    </div>
                    <div class="d-flex align-items-center mb-4">
                        <div class="input-group quantity-selector" style="width: 140px;">
                            <button class="btn btn-outline-secondary" type="button" id="decrement">-</button>
                            <input type="number" class="form-control text-center" id="quantity" value="1" min="1" max="${product.stock}">
                            <button class="btn btn-outline-secondary" type="button" id="increment">+</button>
                        </div>
                        <button class="btn btn-primary btn-lg ms-3" id="addToCartBtn" ${product.stock === 0 ? 'disabled' : ''}>
                            <i class="bi bi-cart-plus"></i> Add to Cart
                        </button>
                    </div>
                </div>
            `;
            
            // Quantity controls
            document.getElementById('increment').addEventListener('click', function() {
                const qty = document.getElementById('quantity');
                if (parseInt(qty.value) < product.stock) qty.value = parseInt(qty.value) + 1;
            });
            document.getElementById('decrement').addEventListener('click', function() {
                const qty = document.getElementById('quantity');
                if (parseInt(qty.value) > 1) qty.value = parseInt(qty.value) - 1;
            });
            
            // Add to cart
            document.getElementById('addToCartBtn').addEventListener('click', function() {
                const quantity = parseInt(document.getElementById('quantity').value);
                addToCart(product.id, quantity);
                showToast('Product added to cart!', 'success');
            });
            
            // Load related products (same category, excluding current)
            const related = products.filter(p => p.category === product.category && p.id !== product.id).slice(0, 4);
            const relatedContainer = document.getElementById('related-products');
            relatedContainer.innerHTML = related.map(p => createProductCard(p)).join('');
        } else {
            window.location.href = 'products.html';
        }
    </script>
</body>
</html>
